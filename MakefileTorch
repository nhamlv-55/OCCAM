PYTORCH_INSTALL=/Users/e32851/workspace/libtorchmac/libtorch

UNAME := $(shell uname)
ifeq ($(UNAME),Darwin)
    DYLIB=dylib
else
    DYLIB=so
endif
PYTORCH_LIBS = $(PYTORCH_INSTALL)/lib/libtorch.${DYLIB}

PYTORCH_LIBS += $(PYTORCH_INSTALL)/lib/libcaffe2.${DYLIB}


PYTORCH_LIBS += $(PYTORCH_INSTALL)/lib/libc10.${DYLIB}
PYTORCH_LIBS += /Users/e32851/Downloads/mklml_mac_2019.0.5.20190502/lib/libmklml.${DYLIB}
LDLIBS := \
     $(PYTORCH_LIBS) 

CXXFLAGS := \
     -Wall \
     -I $(PYTORCH_INSTALL)/include/torch/csrc/api/include \
     -I $(PYTORCH_INSTALL)/include \
     -std=c++11 \
     -O2 -g

# Lookup paths for crab shared libraries
LDFLAGS := -Wl,-rpath,$(PYTORCH_INSTALL)/lib/

all: dcgan

%.o:  $(CXX) $(CXXFLAGS) $< -c -o $@

dcgan: dcgan.o
	$(CXX) $(CXXFLAGS) $(LDFLAGS) dcgan.o $(LDLIBS) -o dcgan

clean:
	rm -f dcgan  *.a *.o
